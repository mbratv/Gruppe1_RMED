-------
# Group 1 Project
Title: "RMED901_Group1_Project_110923"
Authors: "Marianne Br√•tveit, Eline Hillestad, Ryan Dunkel and Jonathan Chambenoit"
Date: "2023-09-11"
Output: html_document

-----
#Day 5 - Reading, exploring, tidying and exploring data

#Importing packages
```{r}
library(tidyverse)
library(here)

here()
data <- read_delim(here("Data", "exam_data.txt")) #Assigning the dataset 
data

```

```{r}
tidy_data <- data %>% rename(BMI = "BMI kg/m2", # Renaming columns 
                Attempts = "# attempts",
                Failures = "# failures") %>% 
  distinct() %>% # Removing duplicates
  pivot_wider(names_from = difficulties_intubating_feature, 
              values_from = difficulties_intubating_value) %>% 
  # Creating three new columns by pivoting wider 
  separate(col = last_method_S_F,
           into = c("last_method", "last_method_S_F"),
           sep = "_") %>% # Splitting the last_method_S_F column into two different columns
  mutate(last_method_S_F = as.double(last_method_S_F),
         last_method = as.double(last_method)) #Converting these two columns to numeric columns as they were turned into character columns when splitting them
  
```

# Day 6
 - Make necessary changes in variable types
    - Create a set of new columns:
        - a column showing gender as "Female" or "Male" instead of "0" or "1"
        - a column showing multiplication of "Mallampati" and "asa" values
        - a column cutting "ease" score into quartiles (4 equal parts); HINT: cut() function
        - a column checking whether the method listed in "which_method" was the same as in "Randomized" column
    - Set the order of columns as: `id, gender, age` and other columns
    - Arrange patient_id column of your dataset in order of increasing number or alphabetically.
    - Connect above steps with pipe.
    - Explore your data.
    - Explore and comment on the missing variables.
    - Stratify your data by a categorical column and report min, max, mean and sd of a numeric column.
    - Stratify your data by a categorical column and report min, max, mean and sd of a numeric column for a defined set of observations - use pipe!
        - Only for persons with BMI <= 40
        - Only for females
        - Only for persons older than 45
        - Only for persons with Mallampati score of 2 or more
    - Use two categorical columns in your dataset to create a table (hint: ?count)
```{r}
og_data <- tidy_data %>% select(-c(month, year)) # Removing the columns month and year 

ad_df <- read_delim(here("Data", "exam_data_join.txt")) # Importing the additional dataset and assigning it to an object

joined_df <- og_data %>% left_join(ad_df, by = "id") %>% distinct() # Deciding to join the original dataframe to the ad_df by the column "id" as this is present in both datasets.

joined_df1 <- joined_df %>% mutate(gender = recode(gender, `0` = "female", `1` = "male")) # Changing the column gender to character observations

joined_df2 <- joined_df1 %>% mutate(Mallampati_asa = (asa*Mallampati)) # Adding a column multiplicating the columns asa and Mallampati

```

